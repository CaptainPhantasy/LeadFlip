# Diagnostic Intelligence + Natural Lead Capture

## The Perfect Balance

**Goal:** Maintain the excellent 10/10 diagnostic conversation while seamlessly collecting contact info.

**Key Principle:** Lead capture should feel like a natural next step, not an interruption.

## Conversation Flow (Ideal)

### Phase 1: Diagnostic Intelligence (3-5 questions)
**Focus:** Understand the problem thoroughly using expert diagnostic questions

**Example - Nighttime Clicking Sound:**
```
User: "Something's wrong with my house"

AI: "I'm here to help! What's been going on?"
    (Warm, open start)

User: "There's this weird sound at night"

AI: "Got it - nighttime noises can definitely be concerning. What does the sound remind you of - is it more like clicking, humming, banging, or scratching?"
    (ONE question, with helpful examples)

User: "Clicking or tapping, kind of rhythmic"

AI: "That sounds like it could be thermal expansion in your pipes or HVAC ducts - pretty common. Does this clicking happen right after your heating or AC turns on or off?"
    (Diagnostic question that identifies root cause)

User: "Actually yeah, now that you mention it, I think it does!"

AI: "Perfect - that's almost certainly thermal expansion. The ducts or pipes expand/contract with temperature changes. Where in your house does it seem loudest?"
    (Confirming diagnosis + gathering more detail)

User: "Maybe in the walls or attic area"

AI: "Got it. One more thing - how long has this been happening?"
    (Timeline for urgency assessment)

User: "About 2 weeks now"
```

**At this point:**
- ✅ Problem thoroughly understood
- ✅ Suspected cause identified (thermal expansion)
- ✅ Location narrowed down (walls/attic)
- ✅ Timeline established (2 weeks)
- ✅ User feels heard and helped

### Phase 2: Location + Budget (2-3 questions)
**Focus:** Practical logistics for matching

```
AI: "Okay, this sounds like a straightforward fix - usually just tightening duct straps or adding insulation to reduce the noise. What's your ZIP code so I can connect you with local HVAC pros?"
    (Context: "straightforward fix" + reason for asking: "connect you with local pros")

User: "46032"

AI: "Got it - Carmel area. For this type of work, most pros charge $150-$400 depending on accessibility. Does that fit your budget, or were you thinking something different?"
    (Setting realistic expectations + open question)

User: "Yeah, that's fine, maybe up to $500"
```

**At this point:**
- ✅ Location captured (46032, Carmel)
- ✅ Budget set ($500 max)
- ✅ User has realistic cost expectations

### Phase 3: Natural Contact Collection (1-2 questions)
**Focus:** Seamless transition from diagnosis to matching

**The Key Moment - Natural Transition:**
```
AI: "Perfect! I have a good understanding of the issue - thermal expansion in your HVAC ducts, not urgent but worth fixing for your peace of mind. I'll connect you with qualified HVAC professionals in the Carmel area who can help. What's the best number to reach you at?"
    (Recap what we learned + WHY we need contact info + natural ask)

User: "317-555-1234"

AI: "Great! And when's usually the best time to reach you - mornings, afternoons, or evenings?"
    (Bonus: Preferred contact time)

User: "Weekday mornings work best"

AI: "Perfect, I have everything I need to connect you with qualified HVAC professionals in Carmel. Let me submit this for you!"
    (Clear completion signal)
```

## Why This Works

### 1. **Trust Built First**
- User shares problem → AI demonstrates expertise
- AI identifies root cause → User feels understood
- **THEN** ask for contact info (not before)

### 2. **Context Provided**
- Not: ❌ "What's your phone number?"
- Instead: ✅ "I'll connect you with qualified pros. What's the best number to reach you at?"

### 3. **Value Proposition Clear**
- User knows WHY they're sharing contact info
- It's to receive help, not for spam

### 4. **Natural Pacing**
- 3-5 questions about the problem (diagnostic intelligence)
- 2 questions about logistics (location, budget)
- 1-2 questions about contact (natural wrap-up)
- Total: 6-9 questions feels conversational, not interrogative

## Bad vs Good Contact Collection

### ❌ BAD (Feels like a form):
```
AI: "Okay, what's your problem?"
User: "Clicking sound at night"
AI: "What's your phone number?"
User: [feels like spam, drops off]
```

### ✅ GOOD (Natural conversation):
```
AI: "Got it - this sounds like thermal expansion in your HVAC ducts, pretty common and usually a quick fix. I'll connect you with qualified HVAC pros in your area. What's the best number to reach you at?"
User: "317-555-1234"
```

**The difference:**
- BAD: Asks for contact before understanding problem
- GOOD: Demonstrates value first, then asks for contact with context

## Context Phrases That Work

Use these transition phrases before asking for contact info:

- ✅ "I'll connect you with qualified [service] professionals in [location]..."
- ✅ "Let me match you with local pros who specialize in this..."
- ✅ "I want to make sure the right pro can reach you..."
- ✅ "So the pros can contact you directly with quotes..."
- ✅ "Since this is [urgent/straightforward/complex], I'll find you [type] who can help..."

## Complete Example: Water Leak (Emergency)

**Diagnostic Phase:**
```
User: "I have a water leak under my sink!"

AI: "I can help with that. Is water actively leaking right now, or has it stopped?"
    (Urgency check first for safety)

User: "It's dripping steadily"

AI: "Okay, that's important to know. Have you been able to turn off the water supply under the sink?"
    (Safety + immediate action)

User: "I tried but the valve won't turn"

AI: "Got it - you'll need a plumber right away to prevent water damage. Where exactly is the leak coming from - the pipe connections, the faucet base, or somewhere else?"
    (Diagnostic detail for pro to prepare)

User: "From the pipe connection where it meets the sink"
```

**Location + Budget:**
```
AI: "Okay, a connection leak - usually a loose fitting or worn seal. Most plumbers can fix this in 30-60 minutes. What's your ZIP code so I can find available plumbers near you?"
    (Context: quick fix + reason for asking)

User: "46032"

AI: "For an emergency call like this, most plumbers charge $150-$300 including parts. Does that work for you?"
    (Transparent pricing)

User: "Yeah, I just need it fixed ASAP"
```

**Natural Contact Collection:**
```
AI: "Absolutely - I'll connect you with emergency plumbers in Carmel who can come out today. What's the best number to reach you at?"
    (Emergency context + clear value)

User: "317-555-1234"

AI: "Perfect. Since this is urgent, I'm submitting this right away so plumbers can contact you within the next 30 minutes!"
    (Urgency acknowledged + clear next step)
```

**Result:**
- ✅ Problem diagnosed (loose pipe connection)
- ✅ Urgency assessed (dripping steadily, valve stuck)
- ✅ User feels safe (given immediate next steps)
- ✅ Contact info collected naturally
- ✅ Clear expectations set (30-minute response time)

## Timing Guidelines

### Diagnostic Intelligence (Keep This!)
- **3-5 focused questions** using issue-specific follow-up logic
- Ask the MOST diagnostic question first
- ONE question at a time
- Build expertise and trust

### Lead Capture (Gently Embedded)
- **After** you understand the problem
- **After** user feels heard
- **With context** about matching/connecting
- Natural transition, not abrupt

### Total Conversation Length
- **Non-emergency:** 6-9 questions (2-3 minutes)
- **Emergency:** 4-6 questions (1-2 minutes, streamlined)

## What We're NOT Changing

### ✅ KEEP (10/10 Diagnostic Intelligence):
- Issue-specific follow-up logic (noise → thermal expansion check)
- ONE question at a time rule
- Diagnostic expertise and recommendations
- Symptoms, suspected causes, pattern extraction
- Natural, empathetic tone

### ✅ ADD (Lead Capture Integration):
- Natural contact collection after diagnosis
- Context phrases for transitions
- Collection order: problem → location → budget → contact
- Clerk fallback for contact info

## System Prompt Summary

The updated system prompt now includes:

1. **Diagnostic Intelligence Section** (unchanged)
   - Issue-specific follow-ups for noise, water, HVAC, electrical
   - ONE question at a time rule
   - Expertise-driven approach

2. **Natural Contact Collection Flow** (new)
   - Bad vs Good examples
   - Timing guidance (after understanding problem)
   - Context phrases that work

3. **Collection Order** (new)
   - 1. Problem diagnosis (3-5 questions)
   - 2. Location (ZIP code)
   - 3. Budget range
   - 4. Contact info (natural transition)
   - 5. Availability (if time permits)

This maintains the excellent diagnostic conversation while ensuring we never lose a lead due to missing contact info.
